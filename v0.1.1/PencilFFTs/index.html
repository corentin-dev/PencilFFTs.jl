<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>PencilFFTs module · PencilFFTs.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>PencilFFTs.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li class="current"><a class="toctext" href>PencilFFTs module</a><ul class="internal"><li><a class="toctext" href="#Types-1">Types</a></li><li><a class="toctext" href="#Functions-1">Functions</a></li><li><a class="toctext" href="#PencilFFTs.measuring_performance-1">Measuring performance</a></li><li><a class="toctext" href="#Devdocs-1">Devdocs</a></li></ul></li><li><a class="toctext" href="../Transforms/">Transforms module</a></li><li><a class="toctext" href="../Pencils/">Pencils module</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>PencilFFTs module</a></li></ul><a class="edit-page" href="https://github.com/jipolanco/PencilFFTs.jl/blob/master/docs/src/PencilFFTs.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>PencilFFTs module</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="PencilFFTs-module-1" href="#PencilFFTs-module-1">PencilFFTs module</a></h1><h2><a class="nav-anchor" id="Types-1" href="#Types-1">Types</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PencilFFTs.PencilFFTPlan" href="#PencilFFTs.PencilFFTPlan"><code>PencilFFTs.PencilFFTPlan</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">PencilFFTPlan{T,N,M}</code></pre><p>Plan for N-dimensional FFT-based transform on MPI-distributed data.</p><hr/><pre><code class="language-none">PencilFFTPlan(size_global::Dims{N}, transforms,
              proc_dims::Dims{M}, comm::MPI.Comm, [real_type=Float64];
              fftw_flags=FFTW.ESTIMATE, fftw_timelimit=FFTW.NO_TIMELIMIT,
              transpose_method=TransposeMethods.IsendIrecv(),
              timer=TimerOutput(),
              )</code></pre><p>Create plan for N-dimensional transform.</p><p><code>size_global</code> specifies the global dimensions of the input data.</p><p><code>transforms</code> should be a tuple of length <code>N</code> specifying the transforms to be applied along each dimension. Each element must be a subtype of <a href="../Transforms/#PencilFFTs.Transforms.AbstractTransform"><code>Transforms.AbstractTransform</code></a>. For all the possible transforms, see <a href="../Transforms/#PencilFFTs.Transforms"><code>Transform types</code></a>. Alternatively, <code>transforms</code> may be a single transform that will be automatically expanded into <code>N</code> equivalent transforms. This is illustrated in the example below.</p><p>The transforms are applied one dimension at a time, with the leftmost dimension first for forward transforms. For multidimensional transforms of real data, this means that a real-to-complex transform must be performed along the first dimension, and then complex-to-complex transforms are performed along the other two dimensions (see example below).</p><p>The data is distributed over the MPI processes in the <code>comm</code> communicator. The distribution is performed over <code>M</code> dimensions (with <code>M &lt; N</code>) according to the values in <code>proc_dims</code>, which specifies the number of MPI processes to put along each dimension.</p><p><strong>Optional arguments</strong></p><ul><li><p>The floating point precision can be selected by setting <code>real_type</code> parameter, which is <code>Float64</code> by default.</p></li><li><p>The keyword arguments <code>fftw_flags</code> and <code>fftw_timelimit</code> are passed to the <code>FFTW</code> plan creation functions (see <a href="https://juliamath.github.io/AbstractFFTs.jl/stable/api/#AbstractFFTs.plan_fft"><code>AbstractFFTs</code> docs</a>).</p></li><li><p><code>transpose_method</code> allows to select between implementations of the global data transpositions. See the <a href="../Pencils/#LinearAlgebra.transpose!"><code>transpose!</code></a> docs for details.</p></li><li><p><code>timer</code> should be a <code>TimerOutput</code> object. See <a href="../Pencils/#Pencils.measuring_performance-1">Measuring performance</a> for details.</p></li></ul><p><strong>Example</strong></p><p>Suppose we want to perform a 3D transform of real data. The data is to be decomposed along two dimensions, over 8 MPI processes:</p><pre><code class="language-julia">size_global = (64, 32, 128)  # size of real input data

# Perform real-to-complex transform along the first dimension, then
# complex-to-complex transforms along the other dimensions.
transforms = (Transforms.RFFT(), Transforms.FFT(), Transforms.FFT())
# transforms = Transforms.RFFT()  # this is equivalent to the above line

proc_dims = (4, 2)  # 2D decomposition
comm = MPI.COMM_WORLD

plan = PencilFFTPlan(size_global, transforms, proc_dims, comm)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/jipolanco/PencilFFTs.jl/blob/984ede9f1fb6f4bdf449c03552b55ef42aa9ece0/src/pencil_plans.jl#L30-L100">source</a></section><h2><a class="nav-anchor" id="Functions-1" href="#Functions-1">Functions</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PencilFFTs.allocate_input" href="#PencilFFTs.allocate_input"><code>PencilFFTs.allocate_input</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">allocate_input(p::PencilFFTPlan)</code></pre><p>Allocate uninitialised distributed array that can hold input data for the given plan.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jipolanco/PencilFFTs.jl/blob/984ede9f1fb6f4bdf449c03552b55ef42aa9ece0/src/pencil_plans.jl#L349-L354">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PencilFFTs.allocate_output" href="#PencilFFTs.allocate_output"><code>PencilFFTs.allocate_output</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">allocate_output(p::PencilFFTPlan)</code></pre><p>Allocate uninitialised distributed array that can hold output data for the given plan.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jipolanco/PencilFFTs.jl/blob/984ede9f1fb6f4bdf449c03552b55ef42aa9ece0/src/pencil_plans.jl#L357-L362">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PencilFFTs.Pencils.get_timer" href="#PencilFFTs.Pencils.get_timer"><code>PencilFFTs.Pencils.get_timer</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">get_timer(p::Pencil)</code></pre><p>Get <code>TimerOutput</code> attached to a <code>Pencil</code>.</p><p>See <a href="../Pencils/#Pencils.measuring_performance-1">Measuring performance</a> for details.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jipolanco/PencilFFTs.jl/blob/984ede9f1fb6f4bdf449c03552b55ef42aa9ece0/src/Pencils/pencil.jl#L160-L166">source</a><div><div><pre><code class="language-none">get_timer(p::PencilFFTPlan)</code></pre><p>Get <code>TimerOutput</code> attached to a <code>PencilFFTPlan</code>.</p><p>See <a href="#PencilFFTs.measuring_performance-1">Measuring performance</a> for details.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jipolanco/PencilFFTs.jl/blob/984ede9f1fb6f4bdf449c03552b55ef42aa9ece0/src/pencil_plans.jl#L339-L345">source</a></section><h2><a class="nav-anchor" id="PencilFFTs.measuring_performance-1" href="#PencilFFTs.measuring_performance-1">Measuring performance</a></h2><p>It is possible to measure the time spent in different sections of the distributed transforms using the <a href="https://github.com/KristofferC/TimerOutputs.jl">TimerOutput</a> package. This has a (very small) performance overhead, so it is disabled by default. To enable time measurements, call <code>TimerOutputs.enable_debug_timings(PencilFFTs)</code> and <code>TimerOutputs.enable_debug_timings(PencilFFTs.Pencils)</code> after loading <code>PencilFFTs</code>. For more details see the <a href="https://github.com/KristofferC/TimerOutputs.jl#overhead">TimerOutput docs</a>.</p><p>Minimal example:</p><pre><code class="language-julia">using MPI
using PencilFFTs
using TimerOutput

# Enable timing of `PencilFFTs` functions
TimerOutputs.enable_debug_timings(PencilFFTs)
TimerOutputs.enable_debug_timings(PencilFFTs.Pencils)

MPI.Init()

plan = PencilFFTPlan(#= args... =#)

# [do stuff with `plan`...]

# Retrieve and print timing data associated to `plan`
to = get_timer(plan)
print_timer(to)</code></pre><p>By default, each <code>PencilFFTPlan</code> has its own <code>TimerOutput</code>. If you already have a <code>TimerOutput</code>, you can pass it to the <a href="#PencilFFTs.PencilFFTPlan"><code>PencilFFTPlan</code></a> constructor:</p><pre><code class="language-julia">to = TimerOutput()
plan = PencilFFTPlan(..., timer=to)

# [do stuff with `plan`...]

print_timer(to)</code></pre><h2><a class="nav-anchor" id="Devdocs-1" href="#Devdocs-1">Devdocs</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PencilFFTs.GlobalFFTParams" href="#PencilFFTs.GlobalFFTParams"><code>PencilFFTs.GlobalFFTParams</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">GlobalFFTParams{T, N}</code></pre><p>Specifies the global parameters for an N-dimensional distributed transform. These include the element type <code>T</code> and global data sizes of input and output data, as well as the transform types to be performed along each dimension.</p><hr/><pre><code class="language-none">GlobalFFTParams(size_global, transforms, [real_type=Float64])</code></pre><p>Define parameters for N-dimensional transform.</p><p><code>transforms</code> must be a tuple of length <code>N</code> specifying the transforms to be applied along each dimension. Each element must be a subtype of <a href="../Transforms/#PencilFFTs.Transforms.AbstractTransform"><code>Transforms.AbstractTransform</code></a>. For all the possible transforms, see <a href="../Transforms/#PencilFFTs.Transforms"><code>Transform types</code></a>.</p><p>The element type must be a real type accepted by FFTW, i.e. either <code>Float32</code> or <code>Float64</code>.</p><p>Note that the transforms are applied one dimension at a time, with the leftmost dimension first for forward transforms.</p><p><strong>Example</strong></p><p>To perform a 3D FFT of real data, first a real-to-complex FFT must be applied along the first dimension, followed by two complex-to-complex FFTs along the other dimensions:</p><pre><code class="language-julia-repl">julia&gt; size_global = (64, 32, 128);  # size of real input data

julia&gt; transforms = (Transforms.RFFT(), Transforms.FFT(), Transforms.FFT());

julia&gt; fft_params = PencilFFTs.GlobalFFTParams(size_global, transforms);</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/jipolanco/PencilFFTs.jl/blob/984ede9f1fb6f4bdf449c03552b55ef42aa9ece0/src/global_fft.jl#L1-L39">source</a></section><footer><hr/><a class="previous" href="../"><span class="direction">Previous</span><span class="title">Home</span></a><a class="next" href="../Transforms/"><span class="direction">Next</span><span class="title">Transforms module</span></a></footer></article></body></html>
